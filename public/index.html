<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <meta name="theme-color" content="#132865">
  <meta name="msapplication-TileColor" content="#132865">
  <title>Todos</title>
  <style>
    :root {
      --grey: #D8D8D8;
      --royal: #132865;
    }
    * {
      margin: 0;
      padding: 0;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    }
    .focus-outline-0:focus {
      outline: 0;
    }
    .focus-border:focus {
      border: 1px solid rgba(0, 0, 0, 0.25);
      border-radius: 2px;
    }
    .width-100 {
      width: 100%;
    }
    html,
    .height-100 {
      height: 100%;
    }
    .height-100vh {
      height: 100vh;
    }
    .min-width-0 {
      min-width: 0;
    }
    .max-width-100 {
      max-width: 100%;
    }
    .margin-top-60vw {
      margin-top: 60vw;
    }
    .margin-bottom-16 {
      margin-bottom: 1rem;
    }
    .margin-bottom-32 {
      margin-bottom: 2rem;
    }
    .margin-bottom-64 {
      margin-bottom: 4rem;
    }
    .padding-1 {
      padding: 1rem;
    }
    .padding-top-8 {
      padding-top: 0.5rem;
    }
    .padding-right-24 {
      padding-right: 1.5rem;
    }
    .padding-bottom-8 {
      padding-bottom: 0.5rem;
    }
    .padding-bottom-16 {
      padding-bottom: 1rem;
    }
    .padding-bottom-64 {
      padding-bottom: 4rem;
    }
    .padding-left-24 {
      padding-left: 1.5rem;
    }
    .top-0 {
      top: 0;
    }
    .top-16 {
      top: 1rem;
    }
    .left-16 {
      left: 1rem;
    }
    .list-style-none {
      list-style: none;
    }
    .position-absolute {
      position: absolute;
    }
    .position-sticky {
      position: sticky;
    }
    .border-transparent {
      border: 1px solid transparent;
    }
    .border-radius-pill {
      border-radius:9999px;
    }
    .display-flex {
      display: flex;
    }
    .display-inline-flex {
      display: inline-flex;
    }
    .flex-grow-1 {
      flex-grow: 1;
    }
    .align-items-center {
      align-items: center;
    }
    .margin-auto {
      margin: 0 auto;
    }
    .margin-right-1 {
      margin-right: 1rem;
    }
    .padding-top-80 {
      padding-top: 5rem;
    }
    .font-size-1 {
      font-size: 1.5rem;
    }
    .font-size-3 {
      font-size: 3rem;
    }
    .font-weight-normal {
      font-weight: 300;
    }
    .line-height-64 {
      line-height: 4rem;
    }
    .text-align-center {
      text-align: center;
    }
    .border-none {
      border: 0;
    }
    .border-bottom {
      border-bottom: 1px solid #D8D8D8;
    }
    .color-royal {
      color: var(--royal);
    }
    .color-grey {
      color: var(--grey);
    }
    .background-grey {
      background-color: var(--grey);
    }
    .background-royal {
      background-color: var(--royal);
    }
    .fill-royal {
      fill: var(--royal);
    }
    .cursor-pointer {
      cursor: pointer;
    }
    .height-1 {
      height: 1px;
    }
    .background,
    .background-image {
      background-image: url('/background.jpg');
    }

    .background,
    .background-repeat {
      background-repeat: no-repeat;
    }

    .background,
    .background-size-contain {
      background-size: contain;
    }

    .background,
    .background-positon {
      background-position: top right;
    }

    .background-white {
      background-color: white;
    }
    html,
    .overflow-hidden {
      overflow: hidden;
    }
    .overflow-x-hidden {
      overflow-x: hidden;
    }
    .overflow-y-scroll {
      overflow-y: scroll;
      -webkit-overflow-scrolling: touch;
    }
    .overflow-y-hidden {
      overflow-y: hidden;
    }
    .max-width-192 {
      max-width: 12rem;
    }
    .display-none {
      display: none;
    }
    .min-height-100vh {
      min-height: 100vh;
    }
    .width-16 {
      width: 1rem;
    }
    .height-16 {
      height: 1rem;
    }

@media screen and (min-width: 40em) {
  .max-width-tablet {
    max-width: 30rem;
  }
  .margin-top-0-tablet {
    margin-top: 0;
  }
  .margin-left-auto-tablet {
    margin-left: auto;
  }
  .background,
  .background-positon-tablet {
    background-position: center right;
  }
  .padding-top-128-tablet {
    padding-top: 8rem;
  }
  .padding-right-72-tablet {
    padding-right: 4.5rem;
  }
  .padding-left-72-tablet {
    padding-left: 4.5rem;
  }
  .font-size-4-tablet {
    font-size: 4rem;
  }
  .background,
  .background-size-cover-tablet {
    background-size: cover;
  }

}

  </style>
</head>
<body
  class="
    height-100
    background
    overflow-y-scroll
    overflow-x-hidden
  "
>
<svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  width="0"
  height="0"
  style="display:none;"
>
  <symbol id="icon-save" viewBox="0 0 24 24">
    <path d="m21.686 4.836-2.521-2.521c-.095-.095-.223-.148-.357-.148h-2.017-9.582-3.53c-.834 0-1.513.679-1.513 1.513v16.641c0 .834.679 1.513 1.513 1.513h2.521 11.598 2.521c.834 0 1.513-.679 1.513-1.513v-15.129c.001-.133-.052-.262-.146-.356zm-7.921-1.661h2.521v4.538c0 .278-.226.504-.504.504h-2.017zm-6.051 0h5.043v5.043h-4.539c-.278 0-.504-.226-.504-.504zm9.581 17.65h-10.59v-6.051h10.59zm3.53-.504c0 .278-.226.504-.504.504h-2.017v-6.556c0-.278-.226-.504-.504-.504h-11.599c-.278 0-.504.226-.504.504v6.556h-2.018c-.278 0-.504-.226-.504-.504v-16.642c0-.278.226-.504.504-.504h3.026v4.538c0 .834.679 1.513 1.513 1.513h7.564c.834 0 1.513-.679 1.513-1.513v-4.538h1.304l2.226 2.226z"/>
  </symbol>
  <symbol id="icon-trash" viewBox="0 0 32 32 ">
    <path d="m27.7 7.3c-.5-1.6-1.3-2.5-2.3-2.5h-4.8c-.2-1.9-1.4-3.3-2.9-3.3h-3.4c-1.5 0-2.8 1.5-2.9 3.3h-4.9c-1 0-1.8.9-2.3 2.5-.1.5 0 1 .3 1.4.3.3.6.5 1 .5h1l.6 18c.2 3.2 3.1 3.2 4.6 3.2h8.9c1.5 0 4.4 0 4.6-3.3l.3-18h.9c.4 0 .8-.2 1-.5.4-.3.5-.8.3-1.3zm-13.4-4.8h3.4c1 0 1.8 1 2 2.3h-7.3c.1-1.3.9-2.3 1.9-2.3zm9.9 24.7c-.1 1.9-1.3 2.3-3.6 2.3h-8.9c-2.3 0-3.5-.4-3.6-2.3l-.6-17.9h17zm2.5-19.1c0 .1-.1.1-.2.1h-20.9c-.1 0-.2-.1-.2-.1-.2-.1-.2-.3-.2-.5.3-1.1.8-1.8 1.3-1.8h18.9c.5 0 1 .7 1.3 1.8.1.2.1.4 0 .5z"/><path d="m15.5 12.1h1v13.7h-1z"/><path d="m11.3 13.9h1v10h-1z"/><path d="m19.7 13.9h1v10h-1z"/>
  </symbol>
</svg>
  <div
    class="
      min-height-100vh
      max-width-tablet
      margin-top-60vw
      margin-top-0-tablet
      margin-left-auto-tablet
      padding-right-24
      padding-left-24
      padding-right-72-tablet
      padding-left-72-tablet
      padding-bottom-16
      background-white
    "
  >
    <div
      class="
        position-sticky
        top-0
        margin-bottom-64
        padding-top-80
        padding-top-128-tablet
        background-white
      "
    >
      <div
        class="
          display-flex
          align-items-center
        "
      >
        <h1
          class="
            color-grey
            font-size-3
            font-size-4-tablet
          "
        >
          Todos
        </h1>
      </div>
      <form
        action="/todos"
        method="POST"
        class="
          display-flex
          align-items-center
          background-white
        "
      >
        <h2
          class="
            margin-right-1
            font-weight-normal
            color-grey
          "
        >
          +
        </h2>
        <input
          name="text"
          type="text"
          autofocus="autofocus"
          class="
            flex-grow-1
            font-size-1
            color-royal
            border-none
            line-height-64
            focus-outline-0
          "
        />
      </form>
      <hr class="height-1 background-grey border-none"/>
    </div>
    <div
      id="js-message"
      class="
        max-width-192
        margin-auto
        text-align-center
        color-grey
      "
    >
    </div>
    <ul
      class="margin-bottom-32 list-style-none"
      id="js-todos"
    >
    </ul>
    <h2
      id="js-done-title"
      class="
        margin-bottom-16
        color-grey
        display-none
      "
    >
      Done
    </h2>
    <ul
      class="list-style-none"
      id="js-completed"
    >
    </ul>
  </div>
  <div
    class="
      position-absolute
      top-16
      left-16
      display-flex
      align-items-center
      background-royal
      border-radius-pill
      cursor-pointer
    "
  >
    <a
      class="
        display-inline-flex
        padding-top-8
        padding-right-24
        padding-bottom-8
        padding-left-24
      "
      href="https://begin.com"
      target="_blank"
    >
      <img src="/begin-lockup.svg" alt="Begin logo">
    </a>
  </div>
  <script>
    (async function() {

      // GET all todos
      let todos = await (await fetch('/todos', {
        credentials: 'same-origin',
        headers: {
          'Content-Type': 'application/json'
        }
      })).json()

      // Update the DOM with data
      update(todos)

      function update (todos) {
        let list = document.getElementById('js-todos')
        let completed = document.getElementById('js-completed')
        let message = document.getElementById('js-message')
        let current = todos.filter(t => !t.completed)
        let complete = todos.filter(t => t.completed)
        let doneTitle = document.getElementById('js-done-title')
        let done = complete.length && !current.length
        let none = !complete.length && !current.length
        if (none) {
          message.innerHTML = Message({
            src: '/rocket.svg',
            text: 'Let\'s get started!',
            alt: 'Rocket'
          })
        } else if (done) {
          message.innerHTML = Message({
            src: '/astronaut.svg',
            text: 'You did it!',
            alt: 'Astronaut'
          })
        }

        if (complete.length) {
          doneTitle.classList.toggle('display-none')
        }

        list && current.length
          ? list.innerHTML = current.map(t => Todo(t)).join('')
          : ''

        completed && complete.length
          ? completed.innerHTML = complete.map(t => Todo(t)).join('')
          : ''
      }

      function Message (props) {
        props = props || {}
        let src = props.src || ''
        let text = props.text || ''

        return `
<img class="max-width-100" src="${src}" alt=""/>
<h3 class="font-size-1 font-weight-normal">${text}</h3>
        `
      }

      function Todo (props) {
        let text = props.text || ''
        let id = props.key || ''
        let created = props.created
        let checked = props.completed
          ? 'checked="checked"'
          : ''

        return `
<li
  id="${id}"
  class="
    display-flex
    align-items-center
    border-bottom
  "
>
  <form
    action="/todos/${id}"
    method="POST"
    class="
      min-width-0
      display-flex
      align-items-center
      flex-grow-1
    "
  >
    <input
      type="checkbox"
      name="completed"
      class="
        width-16
        margin-right-1
        cursor-pointer
      "
      ${checked}
    >
    <input
      type="text"
      name="text"
      value="${text}"
      class="
        min-width-0
        flex-grow-1
        border-none
        line-height-64
        color-royal
        font-weight-normal
        font-size-1
        focus-outline-0
      "
    >
    <input type="hidden" name="key" value="${id}"/>
    <input type="hidden" name="created" value="${created}"/>
    <button
      class="
        padding-1
        font-size-1
        background-white
        border-transparent
        cursor-pointer
        focus-border
        focus-outline-0
      "
    >

      <svg class="width-16 height-16 fill-royal">
        <use href="#icon-save"></use>
      </svg>
    </button>
  </form>
  <form
    action="/todos/delete"
    method="POST"
  >
    <input type="hidden" name="key" value="${id}" />
    <button
      class="
        padding-1
        font-size-1
        background-white
        border-transparent
        cursor-pointer
        focus-border
        focus-outline-0
      "
    >
      <svg class="width-16 height-16 fill-royal">
        <use href="#icon-trash"></use>
      </svg>
    </button>
  </form>
</li>
        `
      }
    }())
  </script>
</body>
</html>
